"use strict";angular.module("footballer",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngResource","ui.router","ui.bootstrap","ngTable","ngLodash","ngStorage"]).config(["$stateProvider","$urlRouterProvider","$httpProvider",function(e,a,t){e.state("home",{url:"/",templateUrl:"app/main/main.html",controller:"MainCtrl"}).state("league",{url:"/league/{id:3[0-9]{1,2}}",templateUrl:"app/league/league.html",controller:"LeagueCtrl"}).state("team",{url:"/team/{id:[0-9]{1,3}}",templateUrl:"app/team/team.html",controller:"TeamCtrl"}),a.otherwise("/"),t.defaults.headers.common["X-Auth-Token"]="b37342f37fc04a41a0bf3931290bc26f"}]).run(["TeamModel","favouritesService","$localStorage",function(e,a,t){!function(a){t.teams&&(a.teams=t.teams.map(function(a){return new e(a)}))}(a)}]),angular.module("footballer").controller("TeamCtrl",["$scope","$stateParams","Team","TeamModel",function(e,a,t,i){e.id=a.id,e.team={},t.get({id:a.id},function(a){e.team=new i(a),e.team.loadPlayers()})}]),angular.module("footballer").factory("TeamModel",["favouritesService","TeamPlayers","$resource","$q",function(e,a,t,i){function o(e){e&&(this.setData(e),this._id=0)}return o.prototype={setData:function(e){angular.extend(this,e)},get favourite(){return e.isFavourite(this)},get id(){if(0===this._id){var e=this._links.self.href.split("/");this._id=e[e.length-1]}return this._id},addToFavorites:function(a){a.stopPropagation(),this.favourite?e.removeFavourite(this):e.saveFavourite(this)},loadPlayers:function(){var e=this;return i(function(t){a.get({id:e.id},function(a){e.players=a.players,t()})})}},o}]),angular.module("footballer").factory("LeagueTable",["$resource",function(e){return e("http://api.football-data.org/alpha/soccerseasons/:id/leagueTable")}]).factory("Team",["$resource",function(e){return e("http://api.football-data.org/alpha/teams/:id")}]).factory("TeamFixtures",["$resource",function(e){return e("http://api.football-data.org/alpha/teams/:id/fixtures")}]).factory("TeamPlayers",["$resource",function(e){return e("http://api.football-data.org/alpha/teams/:id/players")}]).factory("Leagues",["$resource",function(e){return e("/assets/data/leagues.json")}]).service("initFavourites",["TeamModel","favouritesService","$localStorage",function(e,a,t){!function(a){a.teams=t.teams.map(function(a){return new e(a)})}(a)}]),angular.module("footballer").service("leagueService",["$resource","$q","lodash",function(e,a,t){this.getLeague=function(i){return a(function(a,o){e("/assets/data/leagues.json").query(function(e){if(e){var l=t.find(e,{id:i});l&&a(l)}o("League doesn't exist")})})}}]),angular.module("footballer").service("teamService",["$resource","$q","lodash","TeamModel",function(e,a,t,i){this.getTeams=function(o){return a(function(a){e("http://api.football-data.org/alpha/soccerseasons/:id/teams").get({id:o},function(e){a(t.map(e.teams,function(e){return new i(e)}))})})}}]),angular.module("footballer").service("favouritesService",["lodash","$localStorage",function(e,a){this.teams=[],this.saveFavourite=function(e){this.teams.push(e),a.teams=this.teams},this.isFavourite=function(a){return void 0!==e.find(this.teams,{id:a.id})},this.getFavourites=function(){return this.teams},this.removeFavourite=function(t){e.remove(this.teams,{id:t.id}),a.teams=this.teams}}]),angular.module("footballer").controller("MainCtrl",["$scope","Leagues","favouritesService",function(e,a,t){e.leagues=[],e.teams=t.getFavourites(),a.query(function(a){e.leagues=a})}]),angular.module("footballer").controller("LeagueCtrl",["$scope","$stateParams","$filter","$state","teamService","leagueService",function(e,a,t,i,o,l){e.id=a.id,e.league={},l.getLeague(a.id).then(function(a){e.league=a},function(e){console.log(e),i.transitionTo("home")}),o.getTeams(a.id).then(function(a){e.teams=a})}]),angular.module("footballer").directive("teamThumbnail",function(){return{templateUrl:"app/directives/team.thumbnail.html"}}),angular.module("footballer").run(["$templateCache",function(e){e.put("app/directives/team.thumbnail.html",'<div class="thumbnail thumbnail-team" ui-sref="team({id: {{team.id}}})"><div class="lay-favourite" ng-click="team.addToFavorites($event)" ng-class="{active: team.favourite === true}"><span class="glyphicon glyphicon-star" ng-click="addToFavorite()"></span></div><div class="lay-logo"><img class="logo" ng-src="{{team.crestUrl}}" alt="{{team.name}}"></div><div class="caption"><h3>{{team.name}}</h3><p>{{team.shortName}}</p></div></div>'),e.put("app/league/league.html",'<div class="lay-header container"><div class="jumbotron text-center"><h1>{{league.caption}}</h1><span class="lead">Number of Teams: <span>{{league.numberOfTeams}}</span></span></div></div><div class="lay-body container extended"><div class="well"><input class="ld-search" placeholder="Search ..." ng-model="searchTerm"></div><div class="row"><div class="col-sm-6 col-md-4" ng-repeat="team in teams | filter:searchTerm"><div team-thumbnail=""></div></div></div></div>'),e.put("app/main/main.html",'<div class="lay-header container"><div class="jumbotron text-center"><h1>Welcome to footballer!</h1><p class="lead">Please choose your league ...</p></div><a href="https://github.com/rodolfotorres/footballer"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a></div><div class="lay-body container"><div class="row"><div class="col-sm-6 col-md-4" ng-repeat="league in leagues"><div class="thumbnail thumbnail-league" ui-sref="league({id: {{league.id}}})"><div class="lay-logo"><img class="logo" ng-src="assets/images/{{league.logo}}" alt="{{league.caption}}"></div><div class="caption"><h3>{{league.caption}}</h3><p>{{league.description}}</p><p><a ng-href="{{awesomeThing.url}}">{{awesomeThing.url}}</a></p></div></div></div></div><div class="row" ng-show="teams.length > 0"><div class="lay-favourite-teams">Favourite Teams</div><div class="col-sm-6 col-md-4" ng-repeat="team in teams"><div team-thumbnail=""></div></div></div></div><div class="lay-footer container align"><div class="footer"><div>Powered by <a href="http://api.football-data.org/index">football-data.org</a></div></div></div>'),e.put("app/team/team.html",'<div class="lay-header container"><div class="jumbotron text-center"><div class="row"><div class="col-sm-4 col-md-4"><img class="logo" ng-src="{{team.crestUrl}}" alt="{{team.name}}"></div><div class="col-sm-8 col-md-8 lay-team-detail"><h1>{{team.name}}</h1></div></div></div></div><div class="lay-body container extend"><div class="row"><table ng-table="" class="table lay-players"><tr ng-repeat="player in team.players"><td data-title="\'Jersey Number\'">{{player.jerseyNumber}}</td><td data-title="\'Name\'">{{player.name}}</td><td data-title="\'Date of birth\'">{{player.dateOfBirth}}</td><td data-title="\'Contract until\'">{{player.contractUntil}}</td><td data-title="\'Nationality\'">{{player.nationality}}</td><td data-title="\'Position\'">{{player.position}}</td><td data-title="\'Market value\'">{{player.marketValue}}</td></tr></table></div></div>')}]);